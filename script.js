const playlist = [
    { 
        title: "O Mahi", 
        artist: "Arijit Singh", 
        image: "./images/Ash2.jpg", 
        audio: "./songs/O Mahi O Mahi(PagalWorld.com.cm).mp3",
        duration: "3:45"
    },
    { 
        title: "Chaleya", 
        artist: "Arijit Singh", 
        image: "./images/Ash1.jpeg", 
        audio: "./songs/Chaleya(PagalWorld.com.cm).mp3",
        duration: "4:12"
    }
    ,
    { 
        title: "Maan Meri Jaan", 
        artist: "King", 
        image: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Maan Meri Jaan(PagalWorld.com.cm).mp3",
        duration: "3:50"
    },
    { 
        title: "Pehle Bhi Main", 
        artist: "Raj Shekhar", 
        image: "https://images.unsplash.com/photo-1516280440614-37939bbacd81?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Pehle Bhi Main(PagalWorld.com.cm).mp3",
        duration: "4:05"
    },
    { 
        title: "Phir Na Aisi Raat", 
        artist: "Arijit Singh", 
        image: "https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Phir Na Aisi Raat Aayegi(PagalWorld.com.cm).mp3",
        duration: "3:55"
    },
    { 
        title: "Tere Hawaale", 
        artist: "Arijit Singh & Shilpa Rao", 
        image: "https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fG11c2ljfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Tu Hai Kahan(PagalWorld.com.cm).mp3",
        duration: "4:20"
    },
    { 
        title: "Saari Duniya Jalaa Denge", 
        artist: "B Praak and Jaan", 
        image: "https://images.unsplash.com/photo-1516280440614-37939bbacd81?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Saari Duniya Jalaa Denge(PagalWorld.com.cm).mp3",
        duration: "4:05"
    },
    { 
        title: "Tu Hai Kahan", 
        artist: "Usman Ahad", 
        image: "https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fG11c2ljfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Tu Hai Kahan(PagalWorld.com.cm).mp3",
        duration: "4:20"
    },
    { 
        title: "Ve Haniya", 
        artist: "Sargun Mehta", 
        image: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Ve Haniya(PagalWorld.com.cm).mp3",
        duration: "4:12"
    },
    { 
        title: "Humdard - Lofi Song", 
        artist: "Areijit singh", 
        image: "https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
        audio: "./songs/Humdard - Lofi Song (Slowed Reverb) Arijit Singh - Ek Villain.mp3",
        duration: "3:55"
    },



                 {
                title: "O Mahi", 
                artist: "Arijit Singh", 
                image: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
                duration: "3:45"
            },
            { 
                title: "Chaleya", 
                artist: "Arijit Singh", 
                image: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
                duration: "4:12"
            },
            { 
                title: "Maan Meri Jaan", 
                artist: "King", 
                image: "https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
                duration: "3:50"
            },
            { 
                title: "Pehle Bhi Main", 
                artist: "Raj Shekhar", 
                image: "https://images.unsplash.com/photo-1516280440614-37939bbacd81?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3",
                duration: "4:05"
            },
            { 
                title: "Phir Na Aisi Raat", 
                artist: "Arijit Singh", 
                image: "https://images.unsplash.com/photo-1508700115892-45ecd05ae2ad?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8bXVzaWN8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3",
                duration: "3:55"
            },
            { 
                title: "Tere Hawaale", 
                artist: "Arijit Singh & Shilpa Rao", 
                image: "https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fG11c2ljfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60", 
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3",
                duration: "4:20"
            }
];

let currentAudio = null;
let currentSongIndex = 0;
let isPlaying = false;

const playlistContainer = document.getElementById('playlist');
const modal = document.getElementById('playlist-modal');
const modalSongList = document.getElementById('modal-song-list');
const closeModal = document.getElementById('close-modal');
const playPauseBtn = document.getElementById('play-pause-btn');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const progressBar = document.getElementById('progress-bar');
const progress = document.getElementById('progress');
const currentTimeEl = document.getElementById('current-time');
const durationEl = document.getElementById('duration');
const currentSongImg = document.getElementById('current-song-img');
const currentSongTitle = document.getElementById('current-song-title');
const currentSongArtist = document.getElementById('current-song-artist');
const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
const sidebar = document.getElementById('sidebar');
const sidebarOverlay = document.getElementById('sidebar-overlay');
const searchToggle = document.getElementById('search-toggle');
const searchBar = document.getElementById('search-bar');

// Create playlist cards
playlist.forEach((song, index) => {
    const playlistCard = document.createElement('div');
    playlistCard.classList.add('playlist-card');
    playlistCard.innerHTML = `
        <img src="${song.image}" alt="${song.title}" class="playlist-img">
        <h3>${song.title}</h3>
        <p>${song.artist}</p>
        <button class="play-btn" data-index="${index}">
            <i class="fas fa-play"></i>
        </button>
    `;
    playlistContainer.appendChild(playlistCard);
});

// Mobile menu toggle
mobileMenuToggle.addEventListener('click', function() {
    sidebar.classList.toggle('active');
    sidebarOverlay.classList.toggle('active');
});

// Close sidebar when overlay is clicked
sidebarOverlay.addEventListener('click', function() {
    sidebar.classList.remove('active');
    sidebarOverlay.classList.remove('active');
});

// Search toggle for mobile
searchToggle.addEventListener('click', function() {
    searchBar.classList.toggle('active');
    if (window.innerWidth <= 768) {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
    }
});

// Play button functionality
document.querySelectorAll('.play-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
        e.stopPropagation();
        const index = parseInt(this.getAttribute('data-index'));
        playSong(index);
    });
});

// Playlist card click to open modal
document.querySelectorAll('.playlist-card').forEach(card => {
    card.addEventListener('click', function() {
        openPlaylistModal();
    });
});

// Open playlist modal
function openPlaylistModal() {
    modalSongList.innerHTML = '';
    
    playlist.forEach((song, index) => {
        const songItem = document.createElement('div');
        songItem.classList.add('song-item');
        songItem.innerHTML = `
            <img src="${song.image}" alt="${song.title}">
            <div class="song-info">
                <h4>${song.title}</h4>
                <p>${song.artist}</p>
            </div>
            <span class="song-duration">${song.duration}</span>
            <div class="song-actions">
                <button class="song-action-btn"><i class="far fa-heart"></i></button>
                <button class="song-action-btn play-from-modal" data-index="${index}">
                    <i class="fas fa-play"></i>
                </button>
            </div>
        `;
        modalSongList.appendChild(songItem);
    });
    
    modal.style.display = 'flex';
    
    // Add event listeners to modal play buttons
    document.querySelectorAll('.play-from-modal').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation();
            const index = parseInt(this.getAttribute('data-index'));
            playSong(index);
            modal.style.display = 'none';
        });
    });
}

// Close modal
closeModal.addEventListener('click', function() {
    modal.style.display = 'none';
});

// Close modal when clicking outside
window.addEventListener('click', function(e) {
    if (e.target === modal) {
        modal.style.display = 'none';
    }
});

// Play song function
function playSong(index) {
    if (currentAudio) {
        currentAudio.pause();
    }
    
    currentSongIndex = index;
    const song = playlist[index];
    
    currentAudio = new Audio(song.audio);
    currentAudio.play();
    isPlaying = true;
    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
    
    // Update player UI
    currentSongImg.src = song.image;
    currentSongTitle.textContent = song.title;
    currentSongArtist.textContent = song.artist;
    durationEl.textContent = song.duration;
    
    // Update progress bar as song plays
    currentAudio.addEventListener('timeupdate', updateProgress);
    
    // When song ends, play next
    currentAudio.addEventListener('ended', playNextSong);
    
    // Set the duration when metadata is loaded
    currentAudio.addEventListener('loadedmetadata', function() {
        durationEl.textContent = formatTime(currentAudio.duration);
    });
}

// Play/Pause button
playPauseBtn.addEventListener('click', function() {
    if (!currentAudio) {
        playSong(0);
        return;
    }
    
    if (isPlaying) {
        currentAudio.pause();
        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
    } else {
        currentAudio.play();
        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
    }
    isPlaying = !isPlaying;
});

// Previous button
prevBtn.addEventListener('click', function() {
    let prevIndex = currentSongIndex - 1;
    if (prevIndex < 0) {
        prevIndex = playlist.length - 1;
    }
    playSong(prevIndex);
});

// Next button
nextBtn.addEventListener('click', function() {
    playNextSong();
});

// Play next song
function playNextSong() {
    let nextIndex = currentSongIndex + 1;
    if (nextIndex >= playlist.length) {
        nextIndex = 0;
    }
    playSong(nextIndex);
}

// Update progress bar
function updateProgress() {
    if (currentAudio && currentAudio.duration) {
        const { currentTime, duration } = currentAudio;
        const progressPercent = (currentTime / duration) * 100;
        progress.style.width = `${progressPercent}%`;
        
        // Update time displays
        currentTimeEl.textContent = formatTime(currentTime);
        durationEl.textContent = formatTime(duration);
    }
}

// Format time (seconds to mm:ss)
function formatTime(seconds) {
    if (isNaN(seconds)) return "0:00";
    
    const min = Math.floor(seconds / 60);
    const sec = Math.floor(seconds % 60);
    return `${min}:${sec < 10 ? '0' : ''}${sec}`;
}

// Seek functionality
progressBar.addEventListener('click', function(e) {
    if (!currentAudio || !currentAudio.duration) return;
    
    const progressBarWidth = this.clientWidth;
    const clickX = e.offsetX;
    const duration = currentAudio.duration;
    
    currentAudio.currentTime = (clickX / progressBarWidth) * duration;
});

// Initialize with first song details (but not playing)
if (playlist.length > 0) {
    const firstSong = playlist[0];
    currentSongImg.src = firstSong.image;
    currentSongTitle.textContent = firstSong.title;
    currentSongArtist.textContent = firstSong.artist;
    durationEl.textContent = firstSong.duration;
}

console.log('HarmonyStream Music System initialized successfully!');



